---
phase: 04-contact-conversion
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/contact.astro
  - package.json
autonomous: true
user_setup:
  - service: formspree
    why: "Form backend for email delivery"
    env_vars: []
    account_setup:
      - task: "Create Formspree account"
        location: "https://formspree.io/register"
    dashboard_config:
      - task: "Create a new form and copy the form ID"
        location: "Formspree Dashboard -> New Form"
        note: "Form ID looks like 'xabcdefg' - will be used in form action URL"

must_haves:
  truths:
    - "User can navigate to /contact page"
    - "User can fill in name, email, project type, and message"
    - "User sees inline validation errors for invalid fields"
    - "User sees success message after valid submission"
    - "User sees error message with email fallback if submission fails"
  artifacts:
    - path: "src/pages/contact.astro"
      provides: "Contact page with form, validation, and submission"
      min_lines: 150
      contains: ["formspree.io", "addEventListener", "validity"]
    - path: "package.json"
      provides: "lucide-static dependency"
      contains: "lucide-static"
  key_links:
    - from: "src/pages/contact.astro"
      to: "https://formspree.io/f/{FORM_ID}"
      via: "form action attribute and fetch submission"
      pattern: "formspree\\.io/f/"
---

<objective>
Create the /contact page with a fully functional contact form including HTML5 validation, client-side error display, and Formspree submission with success/error feedback.

Purpose: Enable visitors to easily contact Joel with clear UX feedback at every step.
Output: A working contact page with form validation and submission logic.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-contact-conversion/04-CONTEXT.md
@.planning/phases/04-contact-conversion/04-RESEARCH.md
@src/layouts/BaseLayout.astro
@src/pages/index.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install lucide-static and create contact page structure</name>
  <files>package.json, src/pages/contact.astro</files>
  <action>
1. Install lucide-static: `npm install lucide-static`

2. Create src/pages/contact.astro with:
   - Import BaseLayout and Loader2 icon from lucide-static
   - Page title "Contact | Joel Shinness"
   - Main section with headline ("Let's Build Something Together" or similar)
   - Intro paragraph with 48-hour response time promise
   - Form with action="https://formspree.io/f/YOUR_FORM_ID" method="POST"
   - Form fields per CONTEXT.md decisions:
     * Name (text, required, minlength="2")
     * Email (email, required)
     * Project Type (select, optional) with options: "", "Web App", "Automation", "AI Development", "Other"
     * Message (textarea, required, minlength="10", rows="6")
   - Each field with proper label (NOT placeholder-only)
   - Error span with aria-live="polite" after each required field
   - Submit button with loading state structure (text span + hidden loader icon)
   - Privacy reassurance text: "Your info stays between us. No spam, ever."
   - Alternative contact section: "Prefer email? Reach me at joel@example.com" (placeholder email)

3. Style with Tailwind following existing site patterns:
   - Container with max-width and padding
   - Form fields with proper spacing and focus states
   - Error text in red (use text-red-600)
   - Success message styling (green border, centered)
   - Button with accent-teal background, hover state, disabled state

Use :user-invalid CSS pseudo-class for validation styling (shows errors only after user interaction).
  </action>
  <verify>
    - `npm ls lucide-static` shows package installed
    - File src/pages/contact.astro exists
    - `npm run build` succeeds without errors
    - Dev server shows /contact page with form
  </verify>
  <done>Contact page renders with all form fields visible, proper labels, and styled consistently with site design</done>
</task>

<task type="auto">
  <name>Task 2: Implement form validation and Formspree submission</name>
  <files>src/pages/contact.astro</files>
  <action>
Add client-side JavaScript in a script tag at the bottom of contact.astro:

1. Form submission handler:
   - Prevent default form submission
   - Show loading state (disable button, show loader icon, hide text)
   - Submit via fetch with Accept: application/json header (CRITICAL - see RESEARCH.md pitfall)
   - Check response.ok explicitly (fetch doesn't reject on HTTP errors)
   - On success: Replace form with success message div
   - On error: Show error message with email fallback
   - Reset button state in finally block

2. Field-level validation feedback:
   - For each required input, add input and blur event listeners
   - Use validity API to check: valueMissing, typeMismatch, tooShort
   - Show custom error messages in adjacent error span:
     * Name: "Please enter your name." / "Name must be at least 2 characters."
     * Email: "Please enter your email address." / "Please enter a valid email address."
     * Message: "Please enter a message." / "Message must be at least 10 characters."
   - Clear error when field becomes valid

3. Success message content:
   - Heading: "Thanks for reaching out!"
   - Body: "I'll email you within 48 hours with next steps."
   - Style: Green border, padding, centered text

4. Error message content:
   - "Oops! Something went wrong. Email me directly at joel@example.com"
   - Role="alert" for screen reader announcement
   - Dismiss option or auto-clear on retry

Important implementation notes from RESEARCH.md:
- Must include `headers: { 'Accept': 'application/json' }` in fetch
- Only disable button during submission, not during validation
- Keep error spans in DOM from page load (even if empty) for aria-live to work
  </action>
  <verify>
    - Fill form with invalid data, see inline error messages appear
    - Fill form with valid data, submit, see loading state
    - Form submission either shows success or error (depending on Formspree setup)
    - `npm run build` succeeds
  </verify>
  <done>Form validates on input/blur, shows loading during submission, displays success or error message appropriately</done>
</task>

</tasks>

<verification>
1. Navigate to http://localhost:4321/contact
2. Verify all form fields are visible with proper labels
3. Test validation: submit empty form, see error messages
4. Test field validation: enter invalid email, blur, see error
5. Test successful path: fill all required fields, submit
6. Verify loading state appears during submission
7. Verify success or error message appears after submission
8. Run `npm run build` to ensure production build succeeds
</verification>

<success_criteria>
- Contact page accessible at /contact
- Form has name, email, project type (dropdown), and message fields
- Inline validation errors appear for invalid required fields
- Form submits to Formspree with AJAX (no page reload)
- Success message replaces form on successful submission
- Error message with email fallback shows on submission failure
- Build completes without errors
</success_criteria>

<output>
After completion, create `.planning/phases/04-contact-conversion/04-01-SUMMARY.md`
</output>
