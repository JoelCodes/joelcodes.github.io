---
phase: 07-design-system-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/styles/global.css
  - src/layouts/BaseLayout.astro
autonomous: true

must_haves:
  truths:
    - "Site uses yellow/turquoise/magenta color palette visible on all pages"
    - "Colored shadows appear on elements (hard offset in light mode)"
    - "Dark mode converts shadows to colored glows"
    - "Typography uses Bricolage Grotesque for headings and DM Sans for body"
  artifacts:
    - path: "src/styles/global.css"
      provides: "Design tokens for colors, shadows, typography, borders, spacing"
      contains: "@theme"
    - path: "src/layouts/BaseLayout.astro"
      provides: "Google Fonts loading for Bricolage Grotesque and DM Sans"
      contains: "fonts.googleapis.com"
  key_links:
    - from: "src/styles/global.css"
      to: "src/layouts/BaseLayout.astro"
      via: "@import in CSS + font-family CSS variables"
      pattern: "--font-heading.*Bricolage"
---

<objective>
Define the complete neobrutalist design token system including OKLCH colors, colored shadows with dark mode glows, typography with variable fonts, and spacing scale.

Purpose: All Phase 8+ components will consume these tokens. Establishing them now ensures consistency and WCAG compliance.
Output: Updated global.css with @theme tokens, BaseLayout.astro with Google Fonts loading.
</objective>

<execution_context>
@/Users/joel/.claude/get-shit-done/workflows/execute-plan.md
@/Users/joel/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-design-system-foundation/07-CONTEXT.md
@.planning/phases/07-design-system-foundation/07-RESEARCH.md
@src/styles/global.css
@src/layouts/BaseLayout.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Define OKLCH color tokens and shadow utilities</name>
  <files>src/styles/global.css</files>
  <action>
Replace the existing @theme block in global.css with the neobrutalist design tokens.

**Color Tokens (OKLCH format) — exact variable names:**
```css
/* Primary accent colors */
--color-yellow: oklch(0.85 0.18 95);
--color-yellow-hover: oklch(0.80 0.20 95);
--color-turquoise: oklch(0.70 0.15 195);
--color-turquoise-hover: oklch(0.65 0.17 195);
--color-magenta: oklch(0.65 0.20 350);
--color-magenta-hover: oklch(0.60 0.22 350);

/* Dark mode variants (reduced L by 5%, reduced C by 0.02) */
--color-yellow-dark: oklch(0.80 0.16 95);
--color-turquoise-dark: oklch(0.65 0.13 195);
--color-magenta-dark: oklch(0.60 0.18 350);

/* Neutral colors (OKLCH format) */
--color-bg-light: oklch(1.0 0 0);
--color-bg-dark: oklch(0.15 0 0);
--color-text-light: oklch(0.2 0 0);
--color-text-dark: oklch(0.95 0 0);
--color-text-muted-light: oklch(0.5 0 0);
--color-text-muted-dark: oklch(0.7 0 0);
```

**Border Tokens:**
```css
--border-neo: 3px;
--border-neo-thick: 4px;
```

**Spacing Tokens (4pt grid):**
```css
--spacing-neo-xs: 8px;
--spacing-neo-sm: 12px;
--spacing-neo-md: 16px;
--spacing-neo-lg: 24px;
--spacing-neo-xl: 32px;
--spacing-neo-2xl: 64px;
```

**Typography Tokens — font families:**
```css
--font-heading: 'Bricolage Grotesque', ui-sans-serif, system-ui, sans-serif;
--font-body: 'DM Sans', ui-sans-serif, system-ui, sans-serif;
```

**Typography Tokens — font weights:**
```css
--font-weight-h1: 800;
--font-weight-h2: 700;
--font-weight-h3: 600;
--font-weight-h4: 500;
--font-weight-body: 400;
```

**Typography Tokens — font sizes (1.25 ratio scale):**
```css
--text-xs: 0.75rem;    /* 12px */
--text-sm: 0.875rem;   /* 14px */
--text-base: 1rem;     /* 16px */
--text-lg: 1.125rem;   /* 18px */
--text-xl: 1.25rem;    /* 20px */
--text-2xl: 1.5rem;    /* 24px */
--text-3xl: 1.875rem;  /* 30px */
--text-4xl: 2.25rem;   /* 36px */
```

**Typography Tokens — line heights:**
```css
--leading-tight: 1.25;
--leading-normal: 1.5;
--leading-relaxed: 1.75;
```

**Shadow Utilities in @layer utilities:**
Use `@layer utilities` so these work as Tailwind classes (e.g., `class="shadow-neo-yellow"`).
Dark mode variants use `.dark` selector within the utility.

```css
@layer utilities {
  .shadow-neo-yellow {
    box-shadow: 5px 5px 0 var(--color-yellow);
  }
  .dark .shadow-neo-yellow {
    box-shadow: 0 0 20px color-mix(in oklch, var(--color-yellow-dark) 50%, transparent);
  }

  .shadow-neo-turquoise {
    box-shadow: 5px 5px 0 var(--color-turquoise);
  }
  .dark .shadow-neo-turquoise {
    box-shadow: 0 0 20px color-mix(in oklch, var(--color-turquoise-dark) 50%, transparent);
  }

  .shadow-neo-magenta {
    box-shadow: 5px 5px 0 var(--color-magenta);
  }
  .dark .shadow-neo-magenta {
    box-shadow: 0 0 20px color-mix(in oklch, var(--color-magenta-dark) 50%, transparent);
  }

  /* Hover states - pressed effect */
  .shadow-neo-yellow-hover {
    box-shadow: 3px 3px 0 var(--color-yellow);
    transform: translate(2px, 2px);
  }
  .shadow-neo-turquoise-hover {
    box-shadow: 3px 3px 0 var(--color-turquoise);
    transform: translate(2px, 2px);
  }
  .shadow-neo-magenta-hover {
    box-shadow: 3px 3px 0 var(--color-magenta);
    transform: translate(2px, 2px);
  }
}
```

**Keep existing styles below @theme:**
- @custom-variant dark declaration
- Portfolio/blog card animations
- TOC styling
- Prose styling (update to use new font variables)

Update prose h2/h3 to use var(--font-heading) instead of hardcoded 'Poppins'.
  </action>
  <verify>
Run `npm run build` - should complete without CSS errors.
Run these grep commands to verify tokens exist:
- `grep "@theme" src/styles/global.css` - should find theme block
- `grep "shadow-neo" src/styles/global.css` - should find all three shadow utilities
- `grep "color-yellow-dark" src/styles/global.css` - should find dark mode color variants
- `grep "font-weight-h1" src/styles/global.css` - should find font weight tokens
- `grep "text-4xl" src/styles/global.css` - should find font size tokens
  </verify>
  <done>
global.css contains complete @theme block with:
- OKLCH colors with explicit variable names (--color-yellow, --color-turquoise, --color-magenta + dark variants)
- Border widths (--border-neo, --border-neo-thick)
- Spacing scale (--spacing-neo-xs through 2xl)
- Typography tokens (--font-heading, --font-body, --font-weight-h1 through body, --text-xs through 4xl)
- Shadow utilities in @layer utilities with .dark selector for glow effects
  </done>
</task>

<task type="auto">
  <name>Task 2: Update font loading in BaseLayout</name>
  <files>src/layouts/BaseLayout.astro</files>
  <action>
Replace the current font loading (Inter + Poppins) with the neobrutalist fonts (Bricolage Grotesque + DM Sans).

**Changes to make:**

1. Update the preload link href to:
   `https://fonts.googleapis.com/css2?family=Bricolage+Grotesque:opsz,wght@12..96,200..800&family=DM+Sans:opsz,wght@9..40,100..900&display=swap`

2. Update the stylesheet link (the one with media="print") to use the same URL.

3. Update the noscript fallback link to use the same URL.

4. Keep all the preconnect/dns-prefetch links unchanged (they're correct).

5. Update the body class to use the new font token:
   - Change `font-body` to `font-[family-name:var(--font-body)]` OR keep as `font-body` if that maps to the token correctly
   - Actually, Tailwind @theme should automatically create `font-body` from `--font-body`, so `font-body` should work. Verify after build.

**Why variable fonts:**
- Bricolage Grotesque supports opsz (12-96), wght (200-800) - quirky geometric forms
- DM Sans supports opsz (9-40), wght (100-900) - friendly, readable
- Single request per family, flexible weight control
  </action>
  <verify>
Run `npm run dev` and check browser DevTools:
1. Network tab should show fonts.googleapis.com loading Bricolage Grotesque and DM Sans
2. Computed styles on h1 should show font-family includes "Bricolage Grotesque"
3. Computed styles on body text should show font-family includes "DM Sans"
  </verify>
  <done>
BaseLayout.astro loads Bricolage Grotesque and DM Sans via Google Fonts API with variable font axes (opsz, wght) and display=swap.
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify design tokens and dark mode functionality</name>
  <files>src/styles/global.css</files>
  <action>
Run the dev server and verify the design tokens are working, including dark mode colors and shadow glows.

1. Start dev server: `npm run dev`

2. Open browser to localhost:4321 and check:
   - Headings should display in Bricolage Grotesque (quirky geometric letterforms)
   - Body text should display in DM Sans (friendly geometric sans-serif)
   - Fonts should load without flash of unstyled text

3. Check dark mode toggle works with colors and shadows:
   - Click dark mode toggle in header
   - Background should switch from white to near-black
   - Text should switch from dark to light
   - If any shadow utilities are visible, verify they change from hard offset to glow

4. Verify dark mode color variants exist:
   - `grep "color-yellow-dark\|color-turquoise-dark\|color-magenta-dark" src/styles/global.css`
   - Should find all three dark mode color variants

5. Verify shadow glow behavior in dark mode:
   - `grep "\.dark.*shadow-neo" src/styles/global.css`
   - Should find dark mode shadow rules with glow effect (box-shadow: 0 0 20px)

6. Run production build to verify no CSS errors:
   `npm run build`

7. Run Astro check:
   `npm run astro check`

If any errors occur, fix them in global.css and retry.

**Do NOT add any visual component changes** - this task is verification only. Component styling is Phase 8.
  </action>
  <verify>
- `npm run build` exits with code 0
- `npm run astro check` shows no errors
- Browser shows new fonts loaded in DevTools Network tab
- `grep "color-yellow-dark" src/styles/global.css` returns match
- `grep "\.dark.*shadow-neo" src/styles/global.css` returns matches showing glow effect
  </verify>
  <done>
Design tokens verified working: build passes, fonts load correctly, dark mode toggle works (background/text swap), dark mode color variants defined, shadow utilities convert to colored glows in dark mode.
  </done>
</task>

</tasks>

<verification>
1. `npm run build` completes without errors
2. `npm run astro check` shows no TypeScript errors
3. global.css contains @theme with all design tokens (colors, weights, sizes, spacing)
4. global.css contains dark mode color variants (--color-yellow-dark, etc.)
5. global.css contains shadow utilities in @layer utilities with .dark glow variants
6. BaseLayout.astro loads Bricolage Grotesque and DM Sans fonts
7. Browser DevTools shows correct fonts in computed styles
8. Dark mode toggle works (background/text swap + shadow glow conversion)
</verification>

<success_criteria>
- Design tokens defined in global.css: colors (yellow, turquoise, magenta + dark variants), font weights (h1-body), font sizes (xs-4xl), shadows, borders, typography, spacing
- Shadow utilities created in @layer utilities for Tailwind class usage, with .dark selector for glow effects
- Fonts loading from Google Fonts: Bricolage Grotesque + DM Sans with variable axes
- Dark mode color variants verified (reduced lightness/chroma)
- Dark mode shadow glow behavior verified (0 0 20px blur instead of 5px 5px offset)
- Build passes, no regressions in existing functionality
</success_criteria>

<output>
After completion, create `.planning/phases/07-design-system-foundation/07-01-SUMMARY.md`
</output>
