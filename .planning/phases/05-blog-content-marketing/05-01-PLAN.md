---
phase: 05-blog-content-marketing
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/content.config.ts
  - src/content/blog/getting-started-with-automation.mdx
  - astro.config.mjs
autonomous: true

must_haves:
  truths:
    - "Content collection schema validates blog post frontmatter"
    - "MDX files render with syntax highlighted code blocks"
    - "At least one sample blog post exists for testing"
  artifacts:
    - path: "src/content.config.ts"
      provides: "Blog collection schema with Zod validation"
      contains: "defineCollection"
    - path: "src/content/blog/getting-started-with-automation.mdx"
      provides: "Sample blog post with all required frontmatter fields"
      contains: "featuredImage"
    - path: "astro.config.mjs"
      provides: "MDX and Expressive Code integrations"
      contains: "expressiveCode"
  key_links:
    - from: "src/content.config.ts"
      to: "astro:content"
      via: "defineCollection import"
      pattern: "from 'astro:content'"
    - from: "astro.config.mjs"
      to: "expressiveCode"
      via: "integrations array (before mdx)"
      pattern: "expressiveCode\\(\\).*mdx\\(\\)"
---

<objective>
Set up Astro content collections with MDX support and Expressive Code for blog infrastructure.

Purpose: Establish the foundation for all blog functionality - type-safe content management, rich content authoring with MDX, and syntax highlighting with copy buttons.

Output: Working content collection with schema, MDX integration with Expressive Code, and a sample blog post to verify the setup.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-blog-content-marketing/05-CONTEXT.md
@.planning/phases/05-blog-content-marketing/05-RESEARCH.md
@src/styles/global.css
@astro.config.mjs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install MDX and Expressive Code integrations</name>
  <files>astro.config.mjs, package.json</files>
  <action>
Install required packages using the Astro CLI:

1. Run `npx astro add mdx` and accept prompts
2. Run `npx astro add astro-expressive-code` and accept prompts
3. Install reading-time-estimator: `npm install reading-time-estimator`

After installation, verify astro.config.mjs has integrations in correct order:
- `expressiveCode()` MUST come BEFORE `mdx()` in the integrations array
- This is critical - if mdx comes first, code blocks won't have Expressive Code features

If the automated setup puts mdx first, manually reorder to:
```javascript
integrations: [expressiveCode(), mdx()]
```

Keep existing Tailwind/Vite configuration intact.
  </action>
  <verify>
Run `npm run dev` - server should start without errors.
Check astro.config.mjs shows expressiveCode() before mdx() in integrations array.
  </verify>
  <done>
MDX and Expressive Code integrations installed, astro.config.mjs updated with correct integration order (expressiveCode before mdx).
  </done>
</task>

<task type="auto">
  <name>Task 2: Create content collection schema and sample post</name>
  <files>src/content.config.ts, src/content/blog/getting-started-with-automation.mdx</files>
  <action>
Create the content collection configuration at `src/content.config.ts` (Astro 5.0+ location):

```typescript
import { defineCollection, z } from 'astro:content';
import { glob } from 'astro/loaders';

const blog = defineCollection({
  loader: glob({ pattern: "**/*.{md,mdx}", base: "./src/content/blog" }),
  schema: z.object({
    title: z.string(),
    description: z.string(),
    pubDate: z.coerce.date(),
    updatedDate: z.coerce.date().optional(),
    featuredImage: z.string(), // Required per CONTEXT.md
    tags: z.array(z.string()).default([]), // Open-ended tags, multiple allowed
    draft: z.boolean().default(false),
  }),
});

export const collections = { blog };
```

Create directory `src/content/blog/` and a sample post `getting-started-with-automation.mdx`:

```mdx
---
title: "Getting Started with Business Automation"
description: "Learn how automation can save your small business hours each week without complex tools or big budgets."
pubDate: 2026-01-27
featuredImage: "/images/blog/automation-placeholder.svg"
tags: ["automation", "small-business", "productivity"]
draft: false
---

# Getting Started with Business Automation

Most small business owners think automation requires expensive software or technical expertise. The truth? You can start automating today with tools you already have.

## Why Automate?

Every minute spent on repetitive tasks is a minute you could spend growing your business. Here's what automation can handle:

- **Email responses** - Auto-replies, templates, and scheduling
- **Invoice reminders** - Automatic follow-ups on unpaid invoices
- **Data entry** - Moving information between apps automatically
- **Social media** - Scheduled posts and basic engagement

## Start Simple

The best automation is invisible. Start with one process that:

1. Happens frequently (daily or weekly)
2. Follows the same steps every time
3. Doesn't require human judgment

### Example: Invoice Follow-ups

Instead of manually checking who hasn't paid:

```javascript
// Pseudo-code for invoice automation
const overdueInvoices = invoices.filter(
  inv => inv.dueDate < today && !inv.paid
);

overdueInvoices.forEach(invoice => {
  sendReminderEmail(invoice.customer);
  logActivity(`Reminder sent to ${invoice.customer.name}`);
});
```

This simple pattern can save hours each week.

## What's Next?

In future posts, we'll cover:

- Setting up your first Zapier automation
- When to build custom tools vs use existing solutions
- How AI is changing what's possible for small businesses

---

*Have a process you'd like to automate? [Get in touch](/contact) and let's chat about what's possible.*
```

After creating files, run `npx astro sync` to generate TypeScript types for the collection.
  </action>
  <verify>
Run `npx astro sync` - should complete without errors.
Run `npm run dev` and visit any page - build should succeed.
Check that `.astro/types.d.ts` has been updated with blog collection types.
  </verify>
  <done>
Content collection schema exists at src/content.config.ts with all required fields (title, description, pubDate, featuredImage, tags, draft).
Sample blog post exists with valid frontmatter and MDX content including a code block.
`npx astro sync` runs without errors.
  </done>
</task>

</tasks>

<verification>
1. `npm run dev` starts successfully with no errors
2. `npx astro sync` completes without errors
3. astro.config.mjs has expressiveCode() listed before mdx() in integrations
4. src/content.config.ts exists with blog collection schema
5. src/content/blog/ directory contains at least one .mdx file
6. TypeScript recognizes the blog collection (no type errors if importing from 'astro:content')
</verification>

<success_criteria>
- MDX and Expressive Code integrations are installed and configured
- Content collection schema validates blog posts with title, description, pubDate, featuredImage, tags, draft
- Sample blog post exists with code block for testing syntax highlighting
- `astro sync` and `npm run dev` both run without errors
</success_criteria>

<output>
After completion, create `.planning/phases/05-blog-content-marketing/05-01-SUMMARY.md`
</output>
