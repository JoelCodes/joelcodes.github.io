---
phase: 18-component-audit
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/AUDIT.md
autonomous: true

must_haves:
  truths:
    - "Developer can read complete audit listing all component usage inconsistencies"
    - "Audit findings are categorized by severity (CRITICAL/HIGH/MEDIUM/LOW)"
    - "Prioritized migration plan identifies which findings to address"
  artifacts:
    - path: ".planning/AUDIT.md"
      provides: "Component consistency audit document"
      contains: "## Summary"
      min_lines: 100
  key_links:
    - from: ".planning/AUDIT.md"
      to: "Phase 19 migration"
      via: "Migration plan section"
      pattern: "## Migration Plan"
---

<objective>
Systematically audit all UI component usage across the site, identify inconsistencies, classify by severity, and produce actionable documentation for Phase 19 migration.

Purpose: Discovery phase that inventories where design system components (Button, Card, Input, Badge) are used correctly, used incorrectly, or should be used but aren't. This enables Phase 19 to execute targeted fixes.

Output: `.planning/AUDIT.md` with severity-tiered findings grouped by page and a prioritized migration plan.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/18-component-audit/18-CONTEXT.md
@.planning/phases/18-component-audit/18-RESEARCH.md

# Reference for component specifications
@src/components/ui/Button.astro
@src/components/ui/Card.astro
@src/components/ui/Input.astro
@src/components/ui/Badge.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Component Inventory via Grep</name>
  <files>N/A (read-only discovery)</files>
  <action>
Use grep/ripgrep to build a complete inventory of component usage across the codebase.

**Search for component imports and usage:**
```bash
# Find Button usage (component vs raw HTML)
rg "<Button" src/pages/ --count
rg "<button" src/pages/ --count

# Find Card usage
rg "<Card" src/pages/ --count
rg "class=\".*card" src/pages/ -l

# Find Input usage
rg "<Input" src/pages/ --count
rg "<input" src/pages/ --count

# Find Badge usage
rg "<Badge" src/pages/ --count

# Find potential component candidates (Tailwind patterns that duplicate component styles)
rg "border-\[3px\]" src/pages/ -l
rg "shadow-neo" src/pages/ -l
rg "iso-shadow" src/pages/ -l
```

**Record for each page:**
- Component type (Button/Card/Input/Badge)
- Usage count (component vs raw HTML)
- Files where raw HTML used instead of component

**Output:** Working notes (internal) to inform Task 2 verification.
  </action>
  <verify>Grep commands complete without errors; notes capture all pages and component usage patterns</verify>
  <done>Complete inventory of where each component is/isn't used across all 11 pages</done>
</task>

<task type="auto">
  <name>Task 2: Page-by-Page Verification and Severity Classification</name>
  <files>N/A (read-only discovery)</files>
  <action>
For each of the 11 pages, perform manual verification of:

**Pages to audit:**
1. Homepage (`/src/pages/index.astro`)
2. Portfolio index (`/src/pages/projects/index.astro`)
3. Portfolio [slug] (`/src/pages/projects/[slug].astro`)
4. Blog index (`/src/pages/blog/index.astro`)
5. Blog [slug] (`/src/pages/blog/[slug].astro`)
6. Blog tags [tag] (`/src/pages/blog/tags/[tag].astro`)
7. FAQ (`/src/pages/faq.astro`)
8. Design System (`/src/pages/design-system.astro`)
9. Contact (`/src/pages/contact.astro`)
10. Component Demo (`/src/pages/component-demo.astro`)
11. Test Isometric (`/src/pages/test-isometric.astro`)

**For each page, check:**

1. **Component Usage:** Is the design system component used, or raw HTML/Tailwind?
   - Flag raw HTML even if it visually matches (component usage is the goal)

2. **Prop Consistency:** If using component, are props correct?
   - Button: variant (yellow/turquoise/magenta), size (sm/md/lg)
   - Card: variant, stacked
   - Input: variant, label, error handling
   - Badge: variant, label (for a11y), value, description

3. **WCAG Compliance:**
   - Color contrast (4.5:1 for text, 3:1 for UI)
   - Focus states visible (2.4.7 Focus Visible)
   - Touch targets minimum 24x24px (2.5.8)
   - ARIA attributes present where needed
   - Screen reader text for icons

4. **Dark Mode:** Verify both light and dark mode appearance

**Severity Classification (from CONTEXT.md):**
- **CRITICAL**: Blocks users - broken functionality, missing focus states, WCAG violations
- **HIGH**: Brand impact - looks unprofessional, obvious visual breaks
- **MEDIUM**: Minor styling differences, slightly off visuals
- **LOW**: Minor visual/UX differences only

**Consolidation rule:** Same inconsistency on multiple pages = one finding with pages listed.
  </action>
  <verify>All 11 pages reviewed; findings classified with correct severity</verify>
  <done>Complete list of findings with severity, location, impact, and fix suggestions</done>
</task>

<task type="auto">
  <name>Task 3: Write AUDIT.md with Migration Plan</name>
  <files>.planning/AUDIT.md</files>
  <action>
Create `.planning/AUDIT.md` with the following structure:

```markdown
# Component Consistency Audit

**Audit Date:** [date]
**Auditor:** Claude
**Scope:** 11 pages, 4 components (Button, Card, Input, Badge)

## Summary

**Findings by Severity:**
| Severity | Count | Key Themes |
|----------|-------|------------|
| CRITICAL | N | [themes] |
| HIGH | N | [themes] |
| MEDIUM | N | [themes] |
| LOW | N | [themes] |
| INFO | N | (non-component issues noted) |

**Total Findings:** N

## Findings by Page

### Homepage (`/src/pages/index.astro`)

**Component Usage:**
- Button: X instances (component: Y, raw HTML: Z)
- Card: X instances
- Input: X instances
- Badge: X instances

#### [SEVERITY] Finding Title
**Location:** [specific location in page]
**Impact:** [user impact]
**Fix:** [actionable fix suggestion]
**WCAG:** [if applicable]
**Pages affected:** [if multiple]

[Repeat for each finding]

### [Next Page]
[Repeat structure]

## Migration Plan

**Priority Order:** By page traffic (Homepage first)

### Phase 19-01: CRITICAL Fixes
| Finding | Page(s) | Effort |
|---------|---------|--------|
| ... | ... | ... |

### Phase 19-02: HIGH Fixes
[Same table format]

### Phase 19-03: MEDIUM Fixes
[Same table format]

### Phase 19-04: LOW Fixes
[Same table format]

---
*Audit completed: [date]*
*Ready for Phase 19 execution*
```

**Important:**
- Group findings by page for easy reference during migration
- Each finding includes actionable fix suggestion
- Migration plan section orders work for Phase 19
- INFO items are noted but not in migration plan (out of scope)
  </action>
  <verify>AUDIT.md exists at `.planning/AUDIT.md`; contains Summary, Findings by Page, and Migration Plan sections</verify>
  <done>Complete audit document with severity-tiered findings and prioritized migration plan ready for Phase 19</done>
</task>

</tasks>

<verification>
- [ ] All 11 pages audited for component usage
- [ ] All 4 components checked (Button, Card, Input, Badge)
- [ ] WCAG compliance verified (contrast, focus, touch targets, ARIA)
- [ ] Dark mode verified for all visual elements
- [ ] Findings classified by severity (CRITICAL/HIGH/MEDIUM/LOW)
- [ ] Same issue on multiple pages consolidated into single finding
- [ ] Migration plan prioritizes by severity then page traffic
- [ ] AUDIT.md contains actionable fix suggestions
</verification>

<success_criteria>
1. `.planning/AUDIT.md` exists with 100+ lines of content
2. Summary section shows counts by severity level
3. Each page section lists component usage status
4. All WCAG violations flagged as CRITICAL or HIGH
5. Migration plan section exists with Phase 19 work breakdown
6. Raw HTML/Tailwind flagged even if visually correct
</success_criteria>

<output>
After completion, create `.planning/phases/18-component-audit/18-01-SUMMARY.md`
</output>
