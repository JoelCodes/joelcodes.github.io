---
phase: 17-design-system-reference-page
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/pages/design-system.astro
  - src/components/design-system/DesignSystemNav.astro
  - src/components/design-system/CodeBlock.astro
autonomous: true

must_haves:
  truths:
    - "Developer can access /design-system page in browser"
    - "Sidebar navigation is visible on desktop (lg breakpoint+)"
    - "Sidebar stays fixed while main content scrolls"
    - "Page is hidden from search engines (noindex meta tag)"
  artifacts:
    - path: "src/pages/design-system.astro"
      provides: "Main design system documentation page"
      contains: "noindex"
    - path: "src/components/design-system/DesignSystemNav.astro"
      provides: "Sticky sidebar navigation"
      contains: "sticky"
    - path: "src/components/design-system/CodeBlock.astro"
      provides: "Code example with toggle + copy"
      contains: "navigator.clipboard"
  key_links:
    - from: "src/pages/design-system.astro"
      to: "src/components/design-system/DesignSystemNav.astro"
      via: "component import"
      pattern: "import.*DesignSystemNav"
---

<objective>
Create the design system page infrastructure with persistent sidebar navigation, code toggle/copy functionality, and page layout.

Purpose: Establish the foundational structure for design system documentation that subsequent plans will populate with content.
Output: Functional /design-system page with navigation and code display components.
</objective>

<execution_context>
@/Users/joel/.claude/get-shit-done/workflows/execute-plan.md
@/Users/joel/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-design-system-reference-page/17-RESEARCH.md

# Existing patterns to follow
@src/pages/blog/[slug].astro (three-column grid with sticky sidebar)
@src/components/TableOfContents.astro (sticky navigation pattern)
@src/components/layout/Header.astro (client-side script pattern)
@src/layouts/BaseLayout.astro (page layout structure)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create CodeBlock component with toggle and copy</name>
  <files>src/components/design-system/CodeBlock.astro</files>
  <action>
Create `/src/components/design-system/CodeBlock.astro` with:

1. **Props interface:**
   - `code: string` - The code snippet to display
   - `lang?: string` - Language for syntax highlighting (default: 'astro')
   - `title?: string` - Optional title above code block

2. **Structure:**
   - Container div with title (if provided)
   - "View Code" toggle button (initially code is hidden)
   - Copy button with success feedback ("Copied!" for 2 seconds)
   - Code content area using Astro's `<Code>` component from `astro:components`

3. **JavaScript (inline `<script>` tag):**
   - Toggle code visibility on button click
   - Use `navigator.clipboard.writeText()` for copy with try/catch
   - Visual feedback: change button text to "Copied!" with success styling

4. **Styling:**
   - Match neobrutalist design (3px borders, shadow-neo-turquoise for code blocks)
   - Button styling consistent with site buttons
   - Code content hidden by default (`display: none`)
   - Add noscript fallback showing code expanded

Per user decision: Use JavaScript toggle (not `<details>`) to match "toggle button" language.
  </action>
  <verify>
1. Import component in test file and render with sample code
2. Verify code is hidden initially
3. Verify toggle button shows/hides code
4. Verify copy button copies to clipboard (test in dev server)
  </verify>
  <done>
CodeBlock component renders with toggle and copy functionality working in browser.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create DesignSystemNav sidebar component</name>
  <files>src/components/design-system/DesignSystemNav.astro</files>
  <action>
Create `/src/components/design-system/DesignSystemNav.astro` with:

1. **Structure:**
   - `<nav>` element with `aria-label="Design system navigation"`
   - Section groups: Introduction, Colors, Typography, Components, Utilities
   - Each section has anchor links to corresponding `#section-id`

2. **Section links (per recommended order from research):**
   - Introduction: `#introduction`
   - Colors: `#colors`
   - Typography: `#typography`
   - Components:
     - `#component-button`
     - `#component-card`
     - `#component-input`
     - `#component-badge`
   - Utilities:
     - `#utility-iso-shadow`
     - `#utility-iso-glow`
     - `#utility-iso-rotate`

3. **Styling:**
   - Match `.toc` styling from global.css for consistency
   - Section headings: uppercase, small text, muted color
   - Links: underline on hover, turquoise accent
   - Nested items indented for hierarchy

4. **Mobile:** Hidden on mobile (lg:block pattern), main content scrollable
  </action>
  <verify>
1. Component renders navigation structure
2. All anchor links point to valid section IDs
3. Styling matches TOC pattern in global.css
4. Hidden on mobile viewports (< lg breakpoint)
  </verify>
  <done>
DesignSystemNav component renders sticky sidebar navigation with all section links.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create main design-system.astro page with layout</name>
  <files>src/pages/design-system.astro</files>
  <action>
Create `/src/pages/design-system.astro` with:

1. **Head section:**
   - Add `<meta name="robots" content="noindex, follow">` via slot
   - Title: "Design System | Joel Shinness"

2. **Layout:**
   - Use BaseLayout wrapper
   - Two-column grid: `grid-cols-1 lg:grid-cols-[250px_1fr] gap-8`
   - Sidebar: sticky, hidden on mobile, contains DesignSystemNav
   - Main content area with placeholder sections

3. **Section structure (semantic HTML with IDs):**
   ```html
   <section id="introduction">...</section>
   <section id="colors">...</section>
   <section id="typography">...</section>
   <section id="components">
     <div id="component-button">...</div>
     <div id="component-card">...</div>
     <div id="component-input">...</div>
     <div id="component-badge">...</div>
   </section>
   <section id="utilities">
     <div id="utility-iso-shadow">...</div>
     <div id="utility-iso-glow">...</div>
     <div id="utility-iso-rotate">...</div>
   </section>
   ```

4. **Sidebar sticky positioning:**
   - `top-[76px]` to clear header
   - `max-h-[calc(100vh-92px)] overflow-y-auto`

5. **Introduction section content:**
   - H1: "Design System"
   - Description: "Internal reference for Joel and AI coding agents. Components, tokens, and utilities for consistent development."
   - Link to JSON endpoint: `/design-system.json`

Per user decision: Page is not in main nav, but /design-system URL works directly.
  </action>
  <verify>
1. `npm run dev` and visit http://localhost:4321/design-system
2. Page loads with sidebar visible on desktop
3. Sidebar stays fixed while scrolling main content
4. Noindex meta tag present in page source
5. View page source confirms semantic section IDs
  </verify>
  <done>
Design system page accessible at /design-system with sticky sidebar, noindex meta tag, and section structure ready for content.
  </done>
</task>

</tasks>

<verification>
1. Run `npm run dev` and visit http://localhost:4321/design-system
2. Verify page loads without errors
3. Verify sidebar is visible on desktop (lg+) and hidden on mobile
4. Verify sidebar stays sticky while scrolling
5. View page source: confirm `<meta name="robots" content="noindex, follow">`
6. Run `npm run build` to verify no build errors
</verification>

<success_criteria>
- [ ] /design-system page accessible in browser
- [ ] Sidebar navigation visible on desktop with all section links
- [ ] Sidebar sticky while main content scrolls
- [ ] CodeBlock component created with toggle + copy functionality
- [ ] noindex meta tag present in page head
- [ ] Semantic section IDs in place for content population
- [ ] `npm run build` succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/17-design-system-reference-page/17-01-SUMMARY.md`
</output>
