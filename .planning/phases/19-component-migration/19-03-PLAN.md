---
phase: 19-component-migration
plan: 03
type: execute
wave: 2
depends_on: ["19-01"]
files_modified:
  - src/pages/projects/index.astro
  - src/pages/blog/index.astro
autonomous: true

must_haves:
  truths:
    - "Filter buttons use Button component with solid/outline variants"
    - "Active filter shows solid variant (yellow on projects, turquoise on blog)"
    - "Inactive filters show outline variant"
    - "JavaScript toggles variant by swapping CSS classes"
    - "Filter functionality unchanged (clicking filters content)"
  artifacts:
    - path: "src/pages/projects/index.astro"
      provides: "Button-based filter UI"
      contains: "import Button from"
    - path: "src/pages/blog/index.astro"
      provides: "Button-based filter UI"
      contains: "import Button from"
  key_links:
    - from: "projects/index.astro"
      to: "Button component"
      via: "class toggling between btn-yellow and btn-outline"
      pattern: "btn-(yellow|outline)"
    - from: "blog/index.astro"
      to: "Button component"
      via: "class toggling between btn-turquoise and btn-outline"
      pattern: "btn-(turquoise|outline)"
---

<objective>
Migrate filter buttons on Portfolio and Blog index pages to Button component.

Purpose: Filter buttons are HIGH severity findings affecting 2 pages. Same pattern, batched for efficiency. JS toggles variant between solid (active) and outline (inactive).

Output: Filter buttons using Button component with variant toggling via CSS class swapping.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/AUDIT.md
@.planning/phases/19-component-migration/19-CONTEXT.md
@.planning/phases/19-component-migration/19-01-SUMMARY.md

@src/pages/projects/index.astro
@src/pages/blog/index.astro
@src/components/ui/Button.astro
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Portfolio index filter buttons</name>
  <files>src/pages/projects/index.astro</files>
  <action>
Import Button component in frontmatter.

Replace raw HTML filter buttons (lines 24-47) with Button components:

```astro
<!-- Filter buttons -->
<div class="flex flex-wrap justify-center gap-3 mb-12">
  <Button
    variant="yellow"
    size="md"
    data-filter="all"
    data-active="true"
    class="filter-btn rounded-full"
  >
    All Projects
  </Button>
  <Button
    variant="outline"
    size="md"
    data-filter="web-apps"
    class="filter-btn rounded-full"
  >
    Web Apps
  </Button>
  <Button
    variant="outline"
    size="md"
    data-filter="automation"
    class="filter-btn rounded-full"
  >
    Automation
  </Button>
  <Button
    variant="outline"
    size="md"
    data-filter="ai-dev"
    class="filter-btn rounded-full"
  >
    AI Development
  </Button>
</div>
```

Update JavaScript to swap CSS classes for variant toggling (not data-variant attributes):
```javascript
function filterSelection(category) {
  const cards = document.getElementsByClassName('project-card');
  for (let i = 0; i < cards.length; i++) {
    cards[i].classList.remove('show');
    const cardCategory = cards[i].getAttribute('data-category');
    if (category === 'all' || cardCategory === category) {
      cards[i].classList.add('show');
    }
  }
}

function setActiveButton(category) {
  const buttons = document.querySelectorAll('.filter-btn');
  buttons.forEach(btn => {
    const isActive = btn.getAttribute('data-filter') === category;
    btn.setAttribute('data-active', isActive ? 'true' : 'false');
    // Toggle Button CSS classes for variant swap
    if (isActive) {
      btn.classList.remove('btn-outline');
      btn.classList.add('btn-yellow');
    } else {
      btn.classList.remove('btn-yellow');
      btn.classList.add('btn-outline');
    }
  });
}

// Add click handlers via event delegation
document.querySelector('.flex.flex-wrap').addEventListener('click', (e) => {
  const btn = e.target.closest('.filter-btn');
  if (btn) {
    const filter = btn.getAttribute('data-filter');
    filterSelection(filter);
    setActiveButton(filter);
  }
});

// Initialize
filterSelection('all');
```

Remove the inline onclick handlers from Button elements (use event delegation instead per Astro best practices).
  </action>
  <verify>
Run `npm run dev` and visit http://localhost:4321/projects.
Click each filter button:
- Active button shows solid yellow background
- Inactive buttons show outline (transparent) style
- Filter correctly shows/hides project cards
  </verify>
  <done>
Portfolio filter buttons use Button component with CSS class toggling for variant swap.
  </done>
</task>

<task type="auto">
  <name>Task 2: Migrate Blog index filter buttons</name>
  <files>src/pages/blog/index.astro</files>
  <action>
Import Button component in frontmatter.

Apply same pattern as Portfolio, but use turquoise as the active variant:

```astro
<!-- Filter buttons -->
<div class="flex flex-wrap justify-center gap-3 mb-12">
  <Button
    variant="turquoise"
    size="md"
    data-filter="all"
    data-active="true"
    class="filter-btn rounded-full"
  >
    All Posts
  </Button>
  {allTags.map((tag) => (
    <Button
      variant="outline"
      size="md"
      data-filter={tag}
      class="filter-btn rounded-full"
    >
      {tag}
    </Button>
  ))}
</div>
```

Update JavaScript to swap CSS classes (btn-turquoise/btn-outline):
```javascript
function setActiveButton(tag) {
  const buttons = document.querySelectorAll('.filter-btn');
  buttons.forEach(btn => {
    const isActive = btn.getAttribute('data-filter') === tag;
    btn.setAttribute('data-active', isActive ? 'true' : 'false');
    // Toggle Button CSS classes for variant swap
    if (isActive) {
      btn.classList.remove('btn-outline');
      btn.classList.add('btn-turquoise');
    } else {
      btn.classList.remove('btn-turquoise');
      btn.classList.add('btn-outline');
    }
  });
}
```

Preserve existing filter logic (filterSelection function) and load more functionality.

Remove inline onclick handlers and use event delegation.
  </action>
  <verify>
Run `npm run dev` and visit http://localhost:4321/blog.
Click each filter button:
- Active button shows solid turquoise background
- Inactive buttons show outline style
- Filter correctly shows/hides blog cards
  </verify>
  <done>
Blog filter buttons use Button component with CSS class toggling for variant swap.
  </done>
</task>

<task type="auto">
  <name>Task 3: Migrate Blog Load More button</name>
  <files>src/pages/blog/index.astro</files>
  <action>
Replace raw HTML Load More button (lines 78-84) with Button component:

```astro
{postsWithMeta.length > 9 && (
  <div class="text-center mt-12">
    <Button
      id="load-more-btn"
      variant="turquoise"
      size="lg"
    >
      Load More Posts
    </Button>
  </div>
)}
```

Update JavaScript loadMorePosts function to use event listener instead of inline onclick:
```javascript
document.getElementById('load-more-btn')?.addEventListener('click', loadMorePosts);
```

Remove inline onclick from the Button.
  </action>
  <verify>
Run `npm run dev` with a blog that has 10+ posts (or temporarily lower INITIAL_POSTS).
Click Load More button:
- Button should work with proper hover/active states
- Posts load correctly
  </verify>
  <done>
Load More button uses Button component with turquoise variant.
  </done>
</task>

</tasks>

<verification>
```bash
# Type check
npm run astro check

# Build succeeds
npm run build
```

Manual testing:
- [ ] Portfolio: All filters work, active state shows yellow solid
- [ ] Portfolio: Focus ring visible when tabbing through filters
- [ ] Blog: All tag filters work, active state shows turquoise solid
- [ ] Blog: Load More button works (if visible)
- [ ] Dark mode: Both pages show correct dark mode styling
</verification>

<success_criteria>
- Zero raw `<button>` elements for filters on projects/index.astro
- Zero raw `<button>` elements for filters on blog/index.astro
- Filter functionality unchanged
- Active filter uses solid variant (yellow/turquoise)
- Inactive filters use outline variant
- All buttons have WCAG 2.4.13 focus states
</success_criteria>

<output>
After completion, create `.planning/phases/19-component-migration/19-03-SUMMARY.md`
</output>
